/*! dialogs-manager v3.0.0 | (c) Kobi Zaltzberg | https://github.com/cobicarmel/dialogs-manager/blob/master/LICENSE.txt
 2016-07-04 15:31 */
!function(a,b){"use strict";var c={widgetsTypes:{},createWidgetType:function(b,d,e){e||(e=this.Widget);var f=function(){e.apply(this,arguments)},g=f.prototype=new e(b);return a.extend(g,d),g.constructor=f,f.extend=function(a,b){return c.createWidgetType(a,b,f)},f},addWidgetType:function(a,b,c){return b&&b.prototype instanceof this.Widget?this.widgetsTypes[a]=b:this.widgetsTypes[a]=this.createWidgetType(a,b,c)},getWidgetType:function(a){return this.widgetsTypes[a]}};c.Instance=function(){var b=this,d={},e={},f=function(){d.body=a("body")},g=function(b){var c={classPrefix:"dialog",effects:{show:"fadeIn",hide:"fadeOut"}};e=a.extend(c,b)};this.createWidget=function(a,d){var e=c.getWidgetType(a),f=new e(a);return d=d||{},f.init(b,d),f.setMessage(d.message),f},this.getSettings=function(a){return a?e[a]:Object.create(e)},this.init=function(a){return g(a),f(),b},b.init()},c.Widget=function(b){var d=this,e={},f={},g={},h=function(b){var c=e.effects[b],d=g.widget;if(a.isFunction(c))c.call(d);else{if(!d[c])throw"Reference Error: The effect "+c+" not found";d[c]()}},i=function(){d.addElement("widget"),d.addElement("message");var a=d.getSettings("id");a&&d.getElements("widget").attr("id",a)},j=function(c,f){var g=c.getSettings();e=d.getDefaultSettings(),e.effects=g.effects;var h=g.classPrefix+"-"+b;e.classes={globalPrefix:g.classPrefix,prefix:h,widget:"dialog-widget"},a.extend(!0,e,f),k()},k=function(){var b=d.getSettings();a.each(b,function(a){var b=a.match(/^on([A-Z].*)/);b&&(b=b[1].charAt(0).toLowerCase()+b[1].slice(1),d.on(b,this))})},l=function(a){return a.replace(/([a-z])([A-Z])/g,function(){return arguments[1]+"-"+arguments[2].toLowerCase()})};this.addElement=function(b,c,d){var f=g[b]=a(c||"<div>"),h=e.classes.prefix+"-";return b=l(b),h+=b,d||(d=b),h+=" "+e.classes.globalPrefix+"-"+d,f.addClass(h),f},this.getSettings=function(a){var b=Object.create(e);return a?b[a]:b},this.init=function(a,b){if(!(a instanceof c.Instance))throw"The "+d.widgetName+" must to be initialized from an instance of DialogsManager.Instance";return d.trigger("init",b),j(a,b),i(),d.buildWidget(),d.attachEvents&&d.attachEvents(),d.trigger("ready"),d},this.getElements=function(a){return a?g[a]:g},this.hide=function(){return h("hide"),d.trigger("hide"),d},this.on=function(a,b){return f[a]||(f[a]=[]),f[a].push(b),d},this.setMessage=function(a){return g.message.html(a),d},this.show=function(a,b){return a&&a.stopPropagation(),g.widget.appendTo("body"),h("show"),d.trigger("show",b),d},this.trigger=function(b,c){var e="on"+b[0].toUpperCase()+b.slice(1);d[e]&&d[e](c);var g=f[b];g&&a.each(g,function(a,b){b.call(d,c)})}},c.Widget.prototype.buildWidget=function(){var a=this.getElements();a.widget.html(a.message)},c.Widget.prototype.getDefaultSettings=function(){return{}},c.Widget.prototype.onHide=function(){},c.Widget.prototype.onShow=function(){},c.Widget.prototype.onInit=function(){},c.Widget.prototype.onReady=function(){},c.addWidgetType("options",{activeKeyUp:function(a){var b=9;a.which===b&&a.preventDefault(),this.hotKeys[a.which]&&this.hotKeys[a.which](this)},activeKeyDown:function(a){var b=9;if(a.which===b){a.preventDefault();var c,d=this.focusedButton.index();a.shiftKey?(c=d-1,0>c&&(c=this.buttons.length-1)):(c=d+1,c>=this.buttons.length&&(c=0)),this.focusedButton=this.buttons[c].focus()}},addButton:function(b){var c=this,d=c.addElement(b.name,a("<button>").text(b.text));c.buttons.push(d);var e=function(){c.getSettings("hideOnButtonClick")&&c.hide(),a.isFunction(b.callback)&&b.callback.call(this,c)};return d.on("click",e),b.hotKey&&(this.hotKeys[b.hotKey]=e),this.getElements("buttonsWrapper").append(d),b.focus&&(this.focusedButton=d),c},bindHotKeys:function(){this.getElements("window").on({keyup:this.activeKeyUp,keydown:this.activeKeyDown})},buildWidget:function(){this.addElement("window",window);var a=this.addElement("widgetHeader"),b=this.addElement("widgetContent"),c=this.addElement("buttonsWrapper"),d=this.getElements();b.append(a,d.message,c),d.widget.html(b)},ensureClosureMethods:function(){var b=this,c=["placeWidget","activeKeyUp","activeKeyDown"];a.each(c,function(){var a=this,c=b[a];b[a]=function(){c.apply(b,arguments)}})},getDefaultSettings:function(){return{position:{my:"center",at:"center center-100"},headerMessage:"",hideOnButtonClick:!0,refreshPosition:!0}},onHide:function(){this.unbindHotKeys(),this.getElements("window").off("resize",this.placeWidget)},onInit:function(){this.ensureClosureMethods(),this.buttons=[],this.hotKeys={},this.focusedButton=null},onReady:function(){this.setHeaderMessage(this.getSettings("headerMessage"))},onShow:function(a){var b=this;b.placeWidget(a),b.getSettings("refreshPosition")&&b.getElements("window").on("resize",b.placeWidget),b.bindHotKeys(),b.focusedButton||(b.focusedButton=b.buttons[0]),b.focusedButton&&b.focusedButton.focus()},placeWidget:function(b){var c=this.getElements(),d=this.getSettings("position");d.of=c.widget,b&&a.extend(d,b),c.widgetContent.position(d)},setHeaderMessage:function(a){return this.getElements("widgetHeader").html(a),this},unbindHotKeys:function(){this.getElements("window").off({keyup:this.activeKeyUp,keydown:this.activeKeyDown})}}),c.addWidgetType("confirm",c.getWidgetType("options").extend("confirm",{onReady:function(){c.getWidgetType("options").prototype.onReady.apply(this,arguments);var a=this.getSettings("strings"),b=27,d="cancel"===this.getSettings("defaultOption");this.addButton({name:"cancel",text:a.cancel,callback:function(a){a.trigger("cancel")},hotKey:b,focus:d}),this.addButton({name:"ok",text:a.confirm,callback:function(a){a.trigger("confirm")},focus:!d})},getDefaultSettings:function(){var a=c.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return a.strings={confirm:"OK",cancel:"Cancel"},a.defaultOption="cancel",a}})),c.addWidgetType("alert",c.getWidgetType("options").extend("alert",{onReady:function(){c.getWidgetType("options").prototype.onReady.apply(this,arguments);var a=this.getSettings("strings");this.addButton({name:"ok",text:a.confirm,callback:function(a){a.trigger("confirm")}})},getDefaultSettings:function(){var a=c.getWidgetType("options").prototype.getDefaultSettings.apply(this,arguments);return a.strings={confirm:"OK"},a}})),c.addWidgetType("popup",{getDefaultSettings:function(){return{position:{my:"center",at:"center",of:window},hide:{delay:5e3}}},onShow:function(){this.getElements("message").position(this.getSettings("position")),setTimeout(this.hide,this.getSettings("hide").delay)}}),b.DialogsManager=c}("function"==typeof require?require("jquery"):jQuery,"undefined"!=typeof module?module.exports:window);